# PNJL 模型 Omega 函数公式文档

## 物理背景

PNJL (Polyakov Nambu-Jona-Lasinio) 模型是研究QCD相变的有效理论，结合了：
- **NJL模型**：描述手征对称性自发破缺
- **Polyakov Loop**：描述色禁闭相变的序参数
- **平均场近似**：处理强相互作用的有效方法

## 核心 Omega 函数

### 总热力学势

```
Ω_total = Ω_chiral + Ω_thermal + Ω_U
```

### 1. 手征贡献 (Ω_chiral)

```
Ω_chiral = 2G_s Σᵢ φᵢ² - 4K_s φ_u φ_d φ_s
```

其中：
- `φᵢ` 是夸克手征凝聚 `⟨q̄ᵢqᵢ⟩`
- `G_s` 是标量四费米子耦合常数
- `K_s` 是六费米子耦合常数

### 2. 热力学贡献 (Ω_thermal)

```
Ω_thermal = -T ∫₀^Λ d³p/(2π)³ Σᵢ ln[1 + L₁e^{-(E_i - μᵢ)/T} + L₂e^{-2(E_i - μᵢ)/T}]
```

其中：
- **积分范围**：动量 p ∈ [0, Λ]，Λ 为三动量截止
- **单粒子能量**：`E_i = √(p² + mᵢ²)`
- **Polyakov Line 组合**：
  - `L₁ = Φ + Φ*` （Φ* 是 Φ 的共轭）
  - `L₂ = ΦΦ*`
- **有效质量**：`mᵢ = m₀ᵢ - 4G_s φᵢ + 2K_s φⱼφₖ`

### 3. Polyakov 势能贡献 (Ω_U)

标准的Polyakov势能：

```
Ω_U = T⁴U(Φ,Φ*,T)
```

具体形式：
```
U(Φ,Φ*,T) = -½a(T)ΦΦ* + b(T)ln[1 - 6ΦΦ* + 4(Φ³ + (Φ*)³) - 3(ΦΦ*)²]
```

温度依赖参数：
- `a(T) = a₀ + a₁(T₀/T) + a₂(T₀/T)²`
- `b(T) = b₃(T₀/T)³`

### 4. 自洽方程

#### 手征凝聚方程
```
φᵢ = m₀ᵢ - 4G_s φᵢ + 2K_s φⱼφₖ - ∂Ω_thermal/∂m₀ᵢ
```

#### Polyakov Loop 方程  
```
∂Ω_total/∂Φ = 0
∂Ω_total/∂Φ* = 0
```

## 数值积分实现

### 被积函数

主要的热力学积分：

```julia
# 对数项被积函数
function log_integrand(p, i, masses, mu, T, Phi)
    E_i = sqrt(p^2 + masses[i]^2)
    L1 = 2*Phi  # 假设实数情况 Φ = Φ*
    L2 = Phi^2
    
    term1 = exp(-(E_i - mu[i])/T)
    term2 = exp(-2*(E_i - mu[i])/T)
    
    return log(1 + L1*term1 + L2*term2)
end

# 积分权重
weight = p^2 / (2π^2)  # 3D球对称
```

### 积分调用

```julia
# 使用统一积分接口
result = integrate(method, nodes, weights, p -> log_integrand(p, i, masses, mu, T, Phi))
```

## 物理量导数

### 压力
```
P = -Ω_total
```

### 夸克数密度
```
nᵢ = -∂Ω_total/∂μᵢ = ∫ d³p/(2π)³ ∂f_i/∂μᵢ
```

其中费米分布：
```
f_i = (L₁e^{-(E_i-μᵢ)/T} + 2L₂e^{-2(E_i-μᵢ)/T}) / (1 + L₁e^{-(E_i-μᵢ)/T} + L₂e^{-2(E_i-μᵢ)/T})
```

### 能量密度
```
ε = -P + Σᵢ μᵢ nᵢ + T s
```

其中熵密度：
```
s = -∂Ω_total/∂T
```

## 相变特征

### 手征相变
- **序参数**：手征凝聚 `φᵢ`
- **相变类型**：交叉过渡或一阶相变

### 色禁闭相变  
- **序参数**：Polyakov Loop `Φ`
- **物理意义**：重夸克自由能

### 临界点
同时满足：
```
∂²Ω/∂φ² = 0  (手征临界点)
∂²Ω/∂Φ² = 0  (禁闭临界点)
```

## 数值实现要点

1. **积分收敛**：选择合适的截止 Λ
2. **自洽求解**：使用Newton-Raphson或其他稳定方法
3. **相变识别**：监控序参数的突变
4. **数值稳定性**：使用安全数学函数

这些公式构成了标准PNJL模型计算的理论基础。
